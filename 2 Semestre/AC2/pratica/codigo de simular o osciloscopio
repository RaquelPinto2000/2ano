#include <detpic32.h>
 
 
int main(void)
{
   int tmrVal;
   configAdc();
  
   while(1)
   {
      resetCoreTimer();              // faz reset ao contador do core timer
         
      AD1CON1bits.ASAM = 1;
      while(0 == IFS1bits.AD1IF);
     
      tmrVal = readCoreTimer();        // lê o valor atual to core timer
      printStr("\nConv. Time=");
      printInt10(tmrVal * 50);        // O período do PBClk = 1/ 20MHz = 50ns
      printStr(" ns - ");
 
      printInt10(ADC1BUF0);
      IFS1bits.AD1IF = 0;              // esta linha tem que estar depois da leitura da ADC
      delay(500);
   }
   return 0;
}